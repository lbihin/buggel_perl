{% load i18n %}
<tr id="shape-row-{{ shape.id }}" class="shape-row shape-row-editing">
  <td class="text-center">
    <span class="shape-icon-pill pill-{{ shape.shape_type }}">
      <i class="bi {{ shape.shape_type_icon }}"></i>
    </span>
  </td>
  <td>
    <input type="text" name="name" value="{{ shape.name }}"
           class="form-control form-control-sm" placeholder="{% trans 'Nom' %}" />
  </td>
  <td>
    <select name="shape_type" class="form-select form-select-sm" style="max-width:140px;">
      <option value="rectangle" {% if shape.shape_type == 'rectangle' %}selected{% endif %}>{% trans "Rectangle" %}</option>
      <option value="square" {% if shape.shape_type == 'square' %}selected{% endif %}>{% trans "Carré" %}</option>
      <option value="circle" {% if shape.shape_type == 'circle' %}selected{% endif %}>{% trans "Cercle" %}</option>
    </select>
  </td>
  <td>
    <!-- Rectangle dims -->
    <div class="dim-fields dim-rectangle {% if shape.shape_type != 'rectangle' %}d-none{% endif %}">
      <div class="d-flex align-items-center gap-1">
        <input type="number" name="width" value="{{ shape.width|default_if_none:'' }}" min="1" class="form-control form-control-sm" style="max-width:70px;" placeholder="{% trans 'L' %}" />
        <span class="text-muted">×</span>
        <input type="number" name="height" value="{{ shape.height|default_if_none:'' }}" min="1" class="form-control form-control-sm" style="max-width:70px;" placeholder="{% trans 'H' %}" />
      </div>
    </div>
    <!-- Square dims -->
    <div class="dim-fields dim-square {% if shape.shape_type != 'square' %}d-none{% endif %}">
      <input type="number" name="size" value="{{ shape.size|default_if_none:'' }}" min="1" class="form-control form-control-sm" style="max-width:70px;" placeholder="{% trans 'Côté' %}" />
    </div>
    <!-- Circle dims -->
    <div class="dim-fields dim-circle {% if shape.shape_type != 'circle' %}d-none{% endif %}">
      <div class="d-flex align-items-center gap-1">
        <span class="text-muted">∅</span>
        <input type="number" name="diameter" value="{{ shape.diameter|default_if_none:'' }}" min="1" class="form-control form-control-sm" style="max-width:70px;" placeholder="{% trans 'Dia' %}" />
      </div>
    </div>
  </td>
  <td></td>
  <td class="td-row-actions">
    <div class="d-flex gap-1 align-items-center">
      <button class="btn btn-sm btn-primary"
              hx-post="{% url 'shapes:shape_save_row_htmx' shape.id %}"
              hx-include="#shape-row-{{ shape.id }}"
              hx-target="#shape-row-{{ shape.id }}"
              hx-swap="outerHTML"
              title="{% trans "Enregistrer" %}">
        <i class="bi bi-check-lg"></i>
      </button>
      <button class="btn btn-sm btn-outline-secondary"
              hx-get="{% url 'shapes:shape_edit_row_htmx' shape.id %}?cancel=true"
              hx-target="#shape-row-{{ shape.id }}"
              hx-swap="outerHTML"
              title="{% trans "Annuler" %}">
        <i class="bi bi-x-lg"></i>
      </button>
      <button class="btn btn-sm btn-outline-danger"
              hx-delete="{% url 'shapes:shape_delete_row_htmx' shape.id %}"
              hx-target="#shape-row-{{ shape.id }}"
              hx-swap="outerHTML"
              hx-confirm="{% blocktrans with name=shape.name %}Supprimer la plaque « {{ name }} » ?{% endblocktrans %}"
              title="{% trans "Supprimer" %}">
        <i class="bi bi-trash"></i>
      </button>
    </div>
    {% if error %}
      <div class="text-danger mt-1 small">{{ error }}</div>
    {% endif %}
  </td>
</tr>
